<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Web Project Fixed Layout v2 Stable</title>
    <style>
        /* --- CSS RESET & BASE --- */
        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; -webkit-user-drag: none; -webkit-tap-highlight-color: transparent; }
        body, html { width: 100%; height: 100%; overflow: hidden; background-color: #000; }

        /* --- BACKGROUND & MAIN CONTAINER (JANGAN DIUBAH) --- */
        #background-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('BACKGROUND.webp');
            background-size: cover; background-position: center; z-index: 0;
        }

        #game-container {
            position: absolute; top: 50%; left: 50%;
            width: 1920px; height: 1080px;
            /* Transform ditangani oleh JS resizeGame */
            transform-origin: center center; z-index: 1;
            overflow: hidden; 
        }

        /* --- UTILITY CLASSES --- */
        .absolute-img { position: absolute; display: block; pointer-events: auto; }
        /* Kelas untuk memastikan elemen selalu di tengah container 1920x1080 */
        .absolute-center {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        }
        .clickable-btn { cursor: pointer; transition: transform 0.1s ease, filter 0.1s ease; }
        .clickable-btn:hover { transform: scale(1.05); filter: brightness(1.1); }
        .clickable-btn:active { transform: scale(0.95); }
        
        /* Helper untuk menyembunyikan/menampilkan */
        .d-none { display: none !important; }
        .d-block { display: block !important; }
        .d-flex { display: flex !important; }
        .opacity-0 { opacity: 0 !important; }
        .opacity-1 { opacity: 1 !important; }

        /* --- ANIMATIONS DEFINITIONS --- */
        /* FADE */
        .anim-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        .anim-fade-out { animation: fadeOut 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }

        /* SLIDE UP FROM BOTTOM (Khusus C1 Intro) */
        .anim-slide-up-enter { animation: slideUpEnter 0.8s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
        @keyframes slideUpEnter {
            from { transform: translate(-50%, 1080px); opacity: 0; } /* Mulai dari bawah layar */
            to { transform: translate(-50%, -50%); opacity: 1; } /* Berhenti di tengah */
        }

        /* POP IN (Untuk Hasil Spin) */
        @keyframes popIn { 0% { transform: scale(0); opacity: 0; } 80% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }

        /* --- PAGE STYLES --- */
        
        /* LANDING PAGE */
        #landing-page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 10; transition: opacity 0.5s; }

        /* STAGE PAGE */
        #stage-page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 5; transition: opacity 0.5s; }

        /* CHALLENGE 1 PAGE */
        #challenge1-page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 15; }
        
        /* Intro C1 Title Image */
        #c1-intro-img { 
            z-index: 20; 
            /* Posisi awal di bawah layar sebelum animasi */
            transform: translate(-50%, 1080px); 
        }

        /* --- SPINNING COMPONENTS --- */
        #spinner-wrapper {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 1200px; height: 300px;
            background: transparent; /* Tidak ada kotak hitam */
            overflow: hidden;
        }
        #spinner-selector {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 4px; height: 100%; background: #FF0000; z-index: 10; box-shadow: 0 0 15px red;
        }
        #spinner-track {
            display: flex; align-items: center; height: 100%;
            position: absolute; left: 0; top: 0; will-change: transform;
        }
        .spin-item {
            width: 200px; height: 200px; margin: 0 10px; flex-shrink: 0; display: flex; justify-content: center; align-items: center;
        }
        .spin-item img { width: 100%; height: 100%; object-fit: contain; }

        /* Tombol SPIN Image */
        #btn-spin-img {
            position: absolute; bottom: 150px; left: 50%; transform: translateX(-50%);
            z-index: 20; transition: transform 0.2s; cursor: pointer;
        }
        #btn-spin-img:hover { transform: translateX(-50%) scale(1.1); }

        /* --- OVERLAYS (MESSAGE & RESULT) --- */
        .overlay-container {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            background: rgba(0,0,0,0.8); z-index: 100;
            display: none; /* Hidden by default */
            justify-content: center; align-items: center;
            opacity: 0; transition: opacity 0.5s; cursor: pointer;
        }
        
        #result-image {
            max-width: 600px; max-height: 600px;
            animation: popIn 0.5s forwards;
        }

        /* Text Title di C1 */
        #text-st { left: 50%; top: 150px; transform: translateX(-50%); z-index: 5; }

    </style>
</head>
<body>

    <div id="background-layer"></div>

    <div id="game-container">
        
        <div id="landing-page">
            <img src="BG OPEN.webp" class="absolute-img" style="left: 249.4px; top: 127.1px;">
            <img src="JUDUL.webp" class="absolute-img" style="left: 478.8px; top: 239.6px;">
            <img src="PLAY.webp" class="absolute-img clickable-btn anim-fade-in" style="left: 795.1px; top: 530px; animation-delay: 0.5s; opacity: 0;" onclick="startStageSequence()">
        </div>

        <div id="stage-page" class="d-none opacity-0">
            <div id="msg-stage" class="overlay-container" onclick="closeMessage('stage')">
                <img src="MESSAGE.webp" class="absolute-center">
            </div>

            <img src="BOOK.webp" class="absolute-center" style="z-index: 2;">
            <img src="TRACK.webp" class="absolute-img" style="left: 430.8px; top: 378px; z-index: 3;">
            
            <div style="z-index: 4;">
                <img src="TEXT-C1.webp" class="absolute-img" style="left: 430.8px; top: 234.2px;">
                <img src="TEXT-C2.webp" class="absolute-img" style="left: 339.2px; top: 742.9px;">
                <img src="TEXT-C3.webp" class="absolute-img" style="left: 1251px; top: 186.4px;">
                <img src="TEXT-WP.webp" class="absolute-img" style="left: 1062.2px; top: 700.9px;">

                <img src="BUTTON-C1.webp" class="absolute-img clickable-btn" style="left: 357.2px; top: 366.2px;" onclick="goToChallenge1()">
                <img src="BUTTON-C2.webp" class="absolute-img clickable-btn" style="left: 650.9px; top: 643.2px;" onclick="alert('Soon')">
                <img src="BUTTON-C3.webp" class="absolute-img clickable-btn" style="left: 1109.7px; top: 312.5px;" onclick="alert('Soon')">
                <img src="PRIZE.webp" class="absolute-img clickable-btn" style="left: 1318.8px; top: 486.5px;" onclick="alert('Soon')">
            </div>
        </div>

        <div id="challenge1-page" class="d-none">
            
            <img src="C1.webp" id="c1-intro-img" class="absolute-center opacity-0">

            <div id="msg-c1" class="overlay-container" onclick="closeMessage('c1')">
                <img src="MESSAGE-C1.webp" class="absolute-center">
            </div>

            <div id="c1-main-content" class="opacity-0">
                <img src="TEXT-ST.webp" id="text-st" class="absolute-img">
                
                <div id="spinner-wrapper">
                    <div id="spinner-selector"></div>
                    <div id="spinner-track"></div> </div>

                <img src="SPIN.webp" id="btn-spin-img" onclick="startSpin()">
            </div>
            
            <div id="result-popup" class="overlay-container" onclick="closeResult()">
                 <img id="result-image" src="" alt="Result">
            </div>

        </div>

    </div>

    <script>
        /* --- CORE: AUTO SCALING (JANGAN DIUBAH) --- */
        function resizeGame() {
            const container = document.getElementById('game-container');
            // Hitung skala berdasarkan rasio layar vs desain 1920x1080
            const scale = Math.min(window.innerWidth / 1920, window.innerHeight / 1080);
            // Terapkan skala dari tengah
            container.style.transform = `translate(-50%, -50%) scale(${scale})`;
        }
        // Jalankan saat load dan resize window
        window.addEventListener('load', resizeGame);
        window.addEventListener('resize', resizeGame);

        /* --- HELPERS --- */
        const getEl = (id) => document.getElementById(id);
        const showEl = (el) => el.classList.remove('d-none');
        const hideEl = (el) => el.classList.add('d-none');

        /* --- NAVIGATION LOGIC --- */

        // 1. Landing -> Stage
        function startStageSequence() {
            const landing = getEl('landing-page');
            const stage = getEl('stage-page');

            landing.classList.add('opacity-0'); // Fade out Landing
            
            setTimeout(() => {
                hideEl(landing);
                showEl(stage);
                // Force Reflow agar transisi opacity jalan
                stage.offsetHeight; 
                stage.classList.remove('opacity-0'); // Fade in Stage

                // Munculkan Message Stage setelah stage terlihat
                setTimeout(() => openOverlay('msg-stage'), 600);
            }, 500);
        }

        // 2. Stage -> Challenge 1 (Revised Transition)
        function goToChallenge1() {
            const stage = getEl('stage-page');
            const c1Page = getEl('challenge1-page');
            const c1Intro = getEl('c1-intro-img');

            // Langkah A: Fade Out Stage
            stage.classList.add('opacity-0');

            setTimeout(() => {
                hideEl(stage);
                showEl(c1Page);
                setupSpinner(); // Siapkan spinner di background

                // Langkah B: Animasi C1 Intro Masuk dari Bawah
                c1Intro.classList.remove('opacity-0');
                c1Intro.classList.add('anim-slide-up-enter');

                // Langkah C: Diam sejenak, lalu Fade Out C1 Intro
                setTimeout(() => {
                    c1Intro.classList.remove('anim-slide-up-enter'); // Hapus anim masuk
                    c1Intro.classList.add('anim-fade-out'); // Tambah anim keluar

                    // Langkah D: Setelah C1 Intro hilang, munculkan Message C1
                    setTimeout(() => {
                        hideEl(c1Intro);
                        openOverlay('msg-c1');
                    }, 500);

                }, 2000); // Waktu C1 Intro tampil di layar sebelum fade out

            }, 500); // Waktu tunggu stage fade out
        }

        /* --- MESSAGE & OVERLAY SYSTEM --- */
        function openOverlay(id) {
            const el = getEl(id);
            showEl(el);
            setTimeout(() => el.classList.remove('opacity-0'), 50);
        }

        function closeMessage(context) {
            const id = (context === 'stage') ? 'msg-stage' : 'msg-c1';
            const el = getEl(id);
            el.classList.add('opacity-0');
            
            setTimeout(() => {
                hideEl(el);
                // Jika menutup message C1, tampilkan konten utama C1 (Spinner dll)
                if(context === 'c1') {
                    const c1Content = getEl('c1-main-content');
                    c1Content.classList.remove('opacity-0');
                    c1Content.classList.add('anim-fade-in');
                }
            }, 500);
        }

        /* --- SPINNING LOGIC --- */
        let hasSpun = false;

        function setupSpinner() {
            const track = getEl('spinner-track');
            track.innerHTML = ''; 
            // Buat 5 set pengulangan F1-F20
            for (let i = 0; i < 5; i++) {
                for (let j = 1; j <= 20; j++) {
                    const item = document.createElement('div');
                    item.className = 'spin-item';
                    item.innerHTML = `<img src="F${j}.webp">`;
                    track.appendChild(item);
                }
            }
        }

        function startSpin() {
            if (hasSpun) return;
            hasSpun = true;
            hideEl(getEl('btn-spin-img')); // Sembunyikan tombol spin

            const track = getEl('spinner-track');
            const itemWidth = 220; // Lebar item + margin
            
            // Tentukan pemenang random (di loop terakhir agar spin lama)
            const randomWinIndex = Math.floor(Math.random() * (95 - 75 + 1)) + 75;
            // Hitung nomor file (F1-F20)
            const winningNumber = (randomWinIndex % 20) + 1; 

            // Kalkulasi posisi agar berhenti di tengah
            const containerWidth = 1200;
            const targetPos = (randomWinIndex * itemWidth) - (containerWidth / 2) + (itemWidth / 2);
            // Tambah sedikit variasi acak
            const randomOffset = Math.floor(Math.random() * 50) - 25; 
            const finalPos = targetPos + randomOffset;

            // Mulai animasi CSS
            track.style.transition = 'transform 6s cubic-bezier(0.15, 0, 0.10, 1)'; 
            track.style.transform = `translateX(-${finalPos}px)`;

            // Callback saat berhenti
            track.addEventListener('transitionend', () => {
                showResult(winningNumber);
            }, { once: true });
        }

        function showResult(number) {
            const img = getEl('result-image');
            img.src = `F${number}.webp`; // Set gambar hasil
            
            // Hapus animasi lama lalu tambahkan lagi untuk memicu ulang
            img.style.animation = 'none';
            img.offsetHeight; /* trigger reflow */
            img.style.animation = 'popIn 0.5s forwards';
            
            openOverlay('result-popup');
        }

        function closeResult() {
            const popup = getEl('result-popup');
            popup.classList.add('opacity-0');
            setTimeout(() => {
                hideEl(popup);
                alert("Silakan refresh untuk mencoba lagi atau lanjut ke challenge berikutnya (jika ada).");
            }, 500);
        }

    </script>
</body>
</html>
