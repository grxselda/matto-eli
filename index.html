<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Web Project Fixed Layout</title>
    <style>
        /* --- CSS RESET & BASE --- */
        * {
            margin: 0; padding: 0; box-sizing: border-box;
            user-select: none; -webkit-user-drag: none;
            -webkit-tap-highlight-color: transparent;
        }

        body, html {
            width: 100%; height: 100%; overflow: hidden; background-color: #000;
        }

        /* --- BACKGROUND & LAYOUT --- */
        #background-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('BACKGROUND (1).webp');
            background-size: cover; background-position: center; z-index: 0;
        }

        #game-container {
            position: absolute; top: 50%; left: 50%;
            width: 1920px; height: 1080px;
            transform-origin: center center; z-index: 1;
        }

        /* --- UTILITY --- */
        .absolute-img { position: absolute; display: block; pointer-events: auto; }
        .absolute-center-img {
            position: absolute; display: block;
            top: 50%; left: 50%; transform: translate(-50%, -50%);
        }

        .clickable-btn { cursor: pointer; transition: transform 0.1s ease, filter 0.1s ease; }
        .clickable-btn:hover { transform: scale(1.05); filter: brightness(1.1); }
        .clickable-btn:active { transform: scale(0.95); }

        /* Helper Transition Classes */
        .fade-transition { transition: opacity 0.5s ease; }
        .opacity-0 { opacity: 0; pointer-events: none; }
        .opacity-1 { opacity: 1; pointer-events: auto; }

        /* --- ANIMATIONS --- */
        @keyframes slideUpNormal { from { opacity: 0; transform: translateY(100px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUpCenter { from { opacity: 0; transform: translate(-50%, -50%) translateY(100px); } to { opacity: 1; transform: translate(-50%, -50%) translateY(0); } }
        @keyframes pulsePlay { 0%, 100% { transform: scale(1); filter: brightness(1); } 50% { transform: scale(1.05); filter: brightness(1.1); } }
        @keyframes popIn { 0% { transform: scale(0); opacity: 0; } 80% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }

        .anim-normal { animation: slideUpNormal 0.8s ease-out forwards; }
        .anim-center { animation: slideUpCenter 0.8s ease-out forwards; }

        /* --- PAGES --- */
        
        /* 1. LANDING PAGE */
        #landing-page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 10; transition: opacity 0.5s ease; }
        #bg-open { left: 249.4px; top: 127.1px; animation: slideUpNormal 0.8s ease-out forwards; opacity: 0; }
        #judul { left: 478.8px; top: 239.6px; animation: slideUpNormal 0.8s ease-out 0.3s forwards; opacity: 0; }
        #btn-play { left: 795.1px; top: 530px; animation: slideUpNormal 0.8s ease-out 0.6s forwards, pulsePlay 2s infinite ease-in-out 1.5s; opacity: 0; }

        /* 2. STAGE PAGE */
        #stage-page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; display: none; z-index: 5; transition: opacity 0.5s ease; }
        .stage-element { opacity: 0; }
        #stage-book { z-index: 2; }
        #stage-track { z-index: 3; left: 430.8px; top: 378px; }
        .stage-top-layer { z-index: 4; }
        #text-c1 { left: 430.8px; top: 234.2px; }
        #text-c2 { left: 339.2px; top: 742.9px; }
        #text-c3 { left: 1251px; top: 186.4px; }
        #text-wp { left: 1062.2px; top: 700.9px; }
        #btn-c1 { left: 357.2px; top: 366.2px; }
        #btn-c2 { left: 650.9px; top: 643.2px; }
        #btn-c3 { left: 1109.7px; top: 312.5px; }
        #btn-prize { left: 1318.8px; top: 486.5px; }

        /* 3. CHALLENGE 1 PAGE */
        #challenge1-page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; display: none; z-index: 15; }
        
        /* Intro C1 Image (Hidden by default) */
        #c1-intro { 
            z-index: 20; opacity: 0; transition: opacity 0.5s ease; pointer-events: none;
        }

        /* Wadah Konten C1 */
        #c1-content { opacity: 0; width: 100%; height: 100%; position: relative; transition: opacity 0.5s ease; }

        /* Text Title Spinning */
        #text-st {
            position: absolute; left: 50%; top: 200px; 
            transform: translateX(-50%); width: 600px; height: auto; z-index: 5;
        }

        /* Container Spinning Box (Revisi: Transparan) */
        #spinner-wrapper {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 1200px; height: 350px;
            background: transparent; /* Hilangkan box hitam */
            border: none;
            overflow: hidden; /* Masking tetap ada */
        }

        /* Garis Penunjuk Tengah */
        #spinner-selector {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 4px; height: 100%; background: #FF0000;
            z-index: 10;
            box-shadow: 0 0 10px red;
        }

        /* Jalur Rel Gambar */
        #spinner-track {
            display: flex; align-items: center;
            height: 100%;
            position: absolute; left: 0; top: 0;
            will-change: transform;
        }

        /* Card Gambar */
        .spin-item {
            width: 200px; height: 200px;
            margin: 0 10px;
            background-color: rgba(255,255,255,0.1); /* Sedikit background item biar keliatan kotak */
            border-radius: 10px;
            flex-shrink: 0;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
        }
        .spin-item img { width: 100%; height: 100%; object-fit: contain; }

        /* Tombol SPIN Image (Revisi) */
        #btn-spin-img {
            position: absolute; bottom: 150px; left: 50%; transform: translateX(-50%);
            width: 200px; height: auto; z-index: 20;
            cursor: pointer; transition: transform 0.1s;
        }
        #btn-spin-img:hover { transform: translateX(-50%) scale(1.1); }
        #btn-spin-img:active { transform: translateX(-50%) scale(0.9); }

        /* --- OVERLAYS --- */
        
        /* Message Overlay */
        .message-overlay {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            display: flex; justify-content: center; align-items: center;
            z-index: 100; cursor: pointer; opacity: 0;
            transition: opacity 0.5s ease;
            background: rgba(0,0,0,0.5); /* Gelap dikit di belakang pesan supaya kebaca */
        }

        /* Result Overlay (Hasil Spin) */
        #result-overlay {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            z-index: 200; /* Paling atas */
            display: none; justify-content: center; align-items: center;
            background: rgba(0,0,0,0.7); /* Background gelap untuk fokus hasil */
            cursor: pointer; opacity: 0; transition: opacity 0.5s ease;
        }

        #result-img {
            max-width: 600px; max-height: 600px;
            animation: popIn 0.5s forwards;
        }
        
    </style>
</head>
<body>

    <div id="background-layer"></div>

    <div id="game-container">
        
        <div id="landing-page">
            <img src="BG OPEN.webp" id="bg-open" class="absolute-img">
            <img src="JUDUL.webp" id="judul" class="absolute-img">
            <img src="PLAY.webp" id="btn-play" class="absolute-img clickable-btn" onclick="startStageSequence()">
        </div>

        <div id="stage-page">
            <div id="msg-stage" class="message-overlay" onclick="closeMessage('stage')">
                <img src="MESSAGE.webp" class="absolute-center-img">
            </div>
            
            <img src="BOOK.webp" id="stage-book" class="absolute-center-img stage-element">
            <img src="TRACK.webp" id="stage-track" class="absolute-img stage-element">
            <img src="TEXT-C1.webp" id="text-c1" class="absolute-img stage-element stage-top-layer">
            <img src="TEXT-C2.webp" id="text-c2" class="absolute-img stage-element stage-top-layer">
            <img src="TEXT-C3.webp" id="text-c3" class="absolute-img stage-element stage-top-layer">
            <img src="TEXT-WP.webp" id="text-wp" class="absolute-img stage-element stage-top-layer">
            <img src="BUTTON-C1.webp" id="btn-c1" class="absolute-img clickable-btn stage-element stage-top-layer" onclick="goToChallenge1()">
            <img src="BUTTON-C2.webp" id="btn-c2" class="absolute-img clickable-btn stage-element stage-top-layer" onclick="goToChallenge2()">
            <img src="BUTTON-C3.webp" id="btn-c3" class="absolute-img clickable-btn stage-element stage-top-layer" onclick="goToChallenge3()">
            <img src="PRIZE.webp" id="btn-prize" class="absolute-img clickable-btn stage-element stage-top-layer" onclick="goToPrize()">
        </div>

        <div id="challenge1-page">
            
            <img src="C1.webp" id="c1-intro" class="absolute-center-img">

            <div id="msg-c1" class="message-overlay" onclick="closeMessage('c1')" style="display: none;">
                <img src="MESSAGE-C1.webp" class="absolute-center-img">
            </div>

            <div id="result-overlay" onclick="closeResult()">
                <img id="result-img" src="" alt="Result">
            </div>

            <div id="c1-content">
                <img src="TEXT-ST.webp" id="text-st" class="absolute-img">
                
                <div id="spinner-wrapper">
                    <div id="spinner-selector"></div>
                    <div id="spinner-track">
                        </div>
                </div>

                <img src="SPIN.webp" id="btn-spin-img" onclick="startSpin()">
            </div>

        </div>

    </div>

    <script>
        /* --- UTILS --- */
        function resizeGame() {
            const container = document.getElementById('game-container');
            const scale = Math.min(window.innerWidth / 1920, window.innerHeight / 1080);
            container.style.transform = `translate(-50%, -50%) scale(${scale})`;
        }
        window.addEventListener('load', resizeGame);
        window.addEventListener('resize', resizeGame);

        /* --- STATE VARIABLES --- */
        let hasSpun = false;

        /* --- NAVIGATION --- */
        function startStageSequence() {
            const landing = document.getElementById('landing-page');
            landing.style.opacity = '0'; // Fade out
            setTimeout(() => {
                landing.style.display = 'none';
                document.getElementById('stage-page').style.display = 'block';
                // Trigger reflow agar opacity transition jalan
                setTimeout(() => document.getElementById('stage-page').style.opacity = '1', 10);
                
                openMessage('msg-stage');
            }, 500);
        }

        function goToChallenge1() {
            const stage = document.getElementById('stage-page');
            
            // 1. Fade Out Stage
            stage.style.opacity = '0';
            
            setTimeout(() => {
                stage.style.display = 'none';
                const c1Page = document.getElementById('challenge1-page');
                c1Page.style.display = 'block';

                // 2. Tampilkan C1 Intro (Fade In)
                const c1Intro = document.getElementById('c1-intro');
                c1Intro.style.opacity = '1';

                // 3. Diam 1.5 detik, lalu Fade Out C1 Intro
                setTimeout(() => {
                    c1Intro.style.opacity = '0';
                    
                    // 4. Setelah C1 hilang, Munculkan Message
                    setTimeout(() => {
                        openMessage('msg-c1');
                        setupSpinner(); // Siapkan spinner di background
                    }, 500);

                }, 2000); // Durasi C1 Intro tampil

            }, 500);
        }

        /* --- MESSAGE SYSTEM --- */
        function openMessage(id) {
            const msg = document.getElementById(id);
            msg.style.display = 'flex';
            // Delay dikit biar transisi opacity jalan
            setTimeout(() => { msg.style.opacity = '1'; }, 50);
        }

        function closeMessage(context) {
            // Context: 'stage' atau 'c1'
            let overlayId = (context === 'stage') ? 'msg-stage' : 'msg-c1';
            const msg = document.getElementById(overlayId);
            
            msg.style.opacity = '0';
            setTimeout(() => {
                msg.style.display = 'none';
                if(context === 'stage') animateStageAssetsIn();
                if(context === 'c1') animateC1AssetsIn();
            }, 500);
        }

        /* --- ANIMATIONS IN --- */
        function animateStageAssetsIn() {
            document.getElementById('stage-book').classList.add('anim-center');
            setTimeout(() => {
                document.querySelectorAll('.stage-element:not(#stage-book)').forEach(el => el.classList.add('anim-normal'));
            }, 300);
        }

        function animateC1AssetsIn() {
            const content = document.getElementById('c1-content');
            content.style.opacity = '1'; // Fade In content C1
        }

        /* --- SPINNING LOGIC (CS:GO STYLE) --- */
        function setupSpinner() {
            const track = document.getElementById('spinner-track');
            track.innerHTML = ''; 
            
            const totalLoops = 5; 
            const totalImages = 20;

            for (let i = 0; i < totalLoops; i++) {
                for (let j = 1; j <= totalImages; j++) {
                    const item = document.createElement('div');
                    item.className = 'spin-item';
                    const img = document.createElement('img');
                    img.src = `F${j}.webp`; 
                    item.appendChild(img);
                    track.appendChild(item);
                }
            }
        }

        function startSpin() {
            if (hasSpun) return; 
            hasSpun = true;
            document.getElementById('btn-spin-img').style.display = 'none'; // Sembunyikan tombol

            const track = document.getElementById('spinner-track');
            const itemWidth = 220; // 200px width + 20px margin
            
            // Random Winner (Index 75 - 95)
            const randomWinIndex = Math.floor(Math.random() * (95 - 75 + 1)) + 75;
            const winningNumber = (randomWinIndex % 20) + 1; // +1 karena F1 start dari 1 bukan 0

            // Kalkulasi Posisi
            const containerWidth = 1200;
            const scrollPosition = (randomWinIndex * itemWidth) - (containerWidth / 2) + (itemWidth / 2);
            const randomOffset = Math.floor(Math.random() * 40) - 20; 
            const finalPosition = scrollPosition + randomOffset;

            // Animasi Spin
            track.style.transition = 'transform 6s cubic-bezier(0.15, 0, 0.10, 1)'; 
            track.style.transform = `translateX(-${finalPosition}px)`;

            // Event saat spin berhenti
            track.addEventListener('transitionend', () => {
                showResult(winningNumber);
            }, { once: true });
        }

        function showResult(number) {
            const resultOverlay = document.getElementById('result-overlay');
            const resultImg = document.getElementById('result-img');
            
            resultImg.src = `F${number}.webp`;
            
            resultOverlay.style.display = 'flex';
            // Reset animasi pop-in
            resultImg.style.animation = 'none';
            resultImg.offsetHeight; /* trigger reflow */
            resultImg.style.animation = 'popIn 0.5s forwards';

            setTimeout(() => { resultOverlay.style.opacity = '1'; }, 50);
        }

        function closeResult() {
            const resultOverlay = document.getElementById('result-overlay');
            resultOverlay.style.opacity = '0';
            setTimeout(() => {
                resultOverlay.style.display = 'none';
                alert("Silakan refresh untuk mencoba lagi atau lanjut ke challenge berikutnya.");
            }, 500);
        }

        /* Placeholder Functions */
        function goToChallenge2() { alert("Challenge 2 Soon"); }
        function goToChallenge3() { alert("Challenge 3 Soon"); }
        function goToPrize() { alert("Prize Soon"); }

    </script>
</body>
</html>
