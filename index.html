<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Web Project Fixed Layout</title>
    <style>
        /* --- CSS RESET & BASE --- */
        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; -webkit-user-drag: none; -webkit-tap-highlight-color: transparent; }
        body, html { width: 100%; height: 100%; overflow: hidden; background-color: #000; }

        /* --- BACKGROUND & CONTAINER --- */
        #background-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('BACKGROUND (1).webp');
            background-size: cover; background-position: center; z-index: 0;
        }

        #game-container {
            position: absolute; top: 50%; left: 50%;
            width: 1920px; height: 1080px;
            transform-origin: center center; z-index: 1;
            overflow: hidden; /* Agar elemen yang keluar layar tidak terlihat */
        }

        /* --- UTILITY CLASSES --- */
        .absolute-img { position: absolute; display: block; pointer-events: auto; }
        .absolute-center-img {
            position: absolute; display: block;
            top: 50%; left: 50%; transform: translate(-50%, -50%);
        }
        .clickable-btn { cursor: pointer; transition: transform 0.1s ease, filter 0.1s ease; }
        .clickable-btn:hover { transform: scale(1.05); filter: brightness(1.1); }
        .clickable-btn:active { transform: scale(0.95); }
        .hidden { display: none; }

        /* --- ANIMATIONS --- */
        @keyframes slideInUp { from { transform: translateY(1080px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes slideOutUp { from { transform: translateY(0); opacity: 1; } to { transform: translateY(-1080px); opacity: 0; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popIn { 0% { transform: scale(0); opacity: 0; } 80% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }

        /* Class untuk memicu animasi via JS */
        .anim-slide-in-up { animation: slideInUp 1s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
        .anim-slide-out-up { animation: slideOutUp 1s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
        .anim-fade-out { animation: fadeOut 0.5s ease-out forwards; }
        .anim-fade-in { animation: fadeIn 0.5s ease-out forwards; }

        /* --- PAGES --- */
        
        /* LANDING PAGE */
        #landing-page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 10; }
        #bg-open, #judul, #btn-play { opacity: 0; } /* Set awal opacity 0 agar bisa dianimasikan masuk */

        /* STAGE PAGE */
        #stage-page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; display: none; z-index: 5; }
        /* Container untuk elemen stage agar bisa digeser barengan saat transisi */
        #stage-content-wrapper { width: 100%; height: 100%; position: absolute; top: 0; left: 0; }

        /* CHALLENGE 1 PAGE */
        #challenge1-page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; display: none; z-index: 15; }
        
        /* Intro C1 Title */
        #c1-intro-img { 
            position: absolute; top: 50%; left: 50%; 
            transform: translate(-50%, -50%); 
            z-index: 20; opacity: 0; /* Awal hidden */
        }

        /* Spinning Area */
        #spinner-wrapper {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 1200px; height: 300px;
            /* Background transparan total */
            background: transparent; 
            border: none;
            overflow: hidden; /* Masking */
        }

        #spinner-selector {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 4px; height: 100%; background: #FF0000;
            z-index: 10; box-shadow: 0 0 15px red;
        }

        #spinner-track {
            display: flex; align-items: center; height: 100%;
            position: absolute; left: 0; top: 0;
            will-change: transform;
        }

        .spin-item {
            width: 200px; height: 200px; margin: 0 10px;
            flex-shrink: 0; display: flex; justify-content: center; align-items: center;
        }
        .spin-item img { width: 100%; height: 100%; object-fit: contain; }

        /* Tombol SPIN Image */
        #btn-spin-img {
            position: absolute; bottom: 150px; left: 50%;
            transform: translateX(-50%);
            width: 250px; height: auto; /* Sesuaikan ukuran gambar */
            cursor: pointer; z-index: 20;
            transition: transform 0.2s;
        }
        #btn-spin-img:hover { transform: translateX(-50%) scale(1.1); }
        #btn-spin-img:active { transform: translateX(-50%) scale(0.9); }

        /* --- OVERLAYS --- */
        .overlay-bg {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            background: rgba(0,0,0,0.8); z-index: 100;
            display: none; justify-content: center; align-items: center;
            opacity: 0; transition: opacity 0.5s;
        }

        /* Result Popup (Hasil Spin) */
        #result-popup {
            z-index: 200; /* Paling atas */
            cursor: pointer;
        }
        #result-image {
            max-width: 600px; max-height: 600px;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        /* Text ST (Title di C1) */
        #text-st { left: 50%; top: 150px; transform: translateX(-50%); z-index: 5; }

    </style>
</head>
<body>

    <div id="background-layer"></div>

    <div id="game-container">
        
        <div id="landing-page">
            <img src="BG OPEN.webp" id="bg-open" class="absolute-img">
            <img src="JUDUL.webp" id="judul" class="absolute-img">
            <img src="PLAY.webp" id="btn-play" class="absolute-img clickable-btn" onclick="startStageSequence()">
        </div>

        <div id="stage-page">
            <div id="stage-content-wrapper">
                <div id="msg-stage" class="overlay-bg" onclick="closeMessage('stage')">
                    <img src="MESSAGE.webp" class="absolute-center-img">
                </div>

                <img src="BOOK.webp" id="stage-book" class="absolute-center-img">
                <img src="TRACK.webp" id="stage-track" class="absolute-img" style="left: 430.8px; top: 378px;">
                
                <img src="TEXT-C1.webp" class="absolute-img" style="left: 430.8px; top: 234.2px;">
                <img src="TEXT-C2.webp" class="absolute-img" style="left: 339.2px; top: 742.9px;">
                <img src="TEXT-C3.webp" class="absolute-img" style="left: 1251px; top: 186.4px;">
                <img src="TEXT-WP.webp" class="absolute-img" style="left: 1062.2px; top: 700.9px;">

                <img src="BUTTON-C1.webp" class="absolute-img clickable-btn" style="left: 357.2px; top: 366.2px;" onclick="goToChallenge1()">
                <img src="BUTTON-C2.webp" class="absolute-img clickable-btn" style="left: 650.9px; top: 643.2px;" onclick="alert('Soon')">
                <img src="BUTTON-C3.webp" class="absolute-img clickable-btn" style="left: 1109.7px; top: 312.5px;" onclick="alert('Soon')">
                <img src="PRIZE.webp" class="absolute-img clickable-btn" style="left: 1318.8px; top: 486.5px;" onclick="alert('Soon')">
            </div>
        </div>

        <div id="challenge1-page">
            
            <img src="C1.webp" id="c1-intro-img">

            <div id="msg-c1" class="overlay-bg" onclick="closeMessage('c1')">
                <img src="MESSAGE-C1.webp" class="absolute-center-img">
            </div>

            <div id="c1-main-content" style="opacity: 0;">
                <img src="TEXT-ST.webp" id="text-st" class="absolute-img">
                
                <div id="spinner-wrapper">
                    <div id="spinner-selector"></div>
                    <div id="spinner-track">
                        </div>
                </div>

                <img src="SPIN.webp" id="btn-spin-img" onclick="startSpin()">
            </div>
            
            <div id="result-popup" class="overlay-bg" onclick="closeResult()">
                <div id="result-container" style="position: relative;">
                     <img id="result-image" src="" alt="Result">
                </div>
            </div>

        </div>

    </div>

    <script>
        /* --- UTILS SCALING --- */
        function resizeGame() {
            const container = document.getElementById('game-container');
            const scale = Math.min(window.innerWidth / 1920, window.innerHeight / 1080);
            container.style.transform = `translate(-50%, -50%) scale(${scale})`;
        }
        window.addEventListener('load', () => { resizeGame(); initLanding(); });
        window.addEventListener('resize', resizeGame);

        /* --- LANDING ANIMATION --- */
        function initLanding() {
            // Manual trigger animasi landing
            const bg = document.getElementById('bg-open');
            const title = document.getElementById('judul');
            const btn = document.getElementById('btn-play');
            
            setTimeout(() => { bg.classList.add('anim-slide-in-up'); bg.style.opacity=1; }, 100);
            setTimeout(() => { title.classList.add('anim-slide-in-up'); title.style.opacity=1; }, 400);
            setTimeout(() => { btn.classList.add('anim-slide-in-up'); btn.style.opacity=1; }, 700);
        }

        /* --- STAGE LOGIC --- */
        function startStageSequence() {
            document.getElementById('landing-page').classList.add('anim-fade-out');
            setTimeout(() => {
                document.getElementById('landing-page').style.display = 'none';
                document.getElementById('stage-page').style.display = 'block';
                
                // Animasi Masuk Stage
                const stageContent = document.getElementById('stage-content-wrapper');
                stageContent.style.animation = 'slideInUp 1s cubic-bezier(0.25, 1, 0.5, 1) forwards';

                // Buka Message Stage
                setTimeout(() => openOverlay('msg-stage'), 800);
            }, 500);
        }

        /* --- TRANSITION STAGE -> CHALLENGE 1 --- */
        function goToChallenge1() {
            // 1. Animasi Stage Keluar ke Atas
            const stageContent = document.getElementById('stage-content-wrapper');
            stageContent.classList.add('anim-slide-out-up');

            // 2. Siapkan Halaman C1
            const c1Page = document.getElementById('challenge1-page');
            const c1Intro = document.getElementById('c1-intro-img');
            
            c1Page.style.display = 'block';
            
            // 3. Animasi Intro "C1" Masuk dari Bawah (Bersamaan dengan Stage keluar)
            // Kita reset animasi dulu
            c1Intro.style.animation = 'none';
            c1Intro.offsetHeight; /* trigger reflow */
            c1Intro.style.animation = 'slideInUp 1s cubic-bezier(0.25, 1, 0.5, 1) forwards';
            c1Intro.style.opacity = '1';

            // 4. Timer untuk sequence selanjutnya
            setTimeout(() => {
                document.getElementById('stage-page').style.display = 'none'; // Hide stage clean up
                
                // Diam sejenak (1 detik), lalu Fade Out C1 Intro
                setTimeout(() => {
                    c1Intro.classList.add('anim-fade-out');
                    
                    // Setelah Fade Out C1 selesai, Buka Message C1
                    setTimeout(() => {
                        openOverlay('msg-c1');
                    }, 500);
                }, 1500); // Waktu C1 Intro diam di layar
            }, 1000); // Waktu animasi slide up
            
            setupSpinner(); // Siapkan gambar spinner di background
        }

        /* --- MESSAGE SYSTEM --- */
        function openOverlay(id) {
            const el = document.getElementById(id);
            el.style.display = 'flex';
            // Force reflow
            el.offsetHeight;
            el.style.opacity = '1';
        }

        function closeMessage(context) {
            const id = (context === 'stage') ? 'msg-stage' : 'msg-c1';
            const el = document.getElementById(id);
            el.style.opacity = '0';
            setTimeout(() => {
                el.style.display = 'none';
                
                // Jika menutup message C1, baru tampilkan konten spinner
                if(context === 'c1') {
                    const c1Content = document.getElementById('c1-main-content');
                    c1Content.style.opacity = '1';
                    c1Content.classList.add('anim-fade-in');
                }
            }, 500);
        }

        /* --- SPINNING LOGIC --- */
        let hasSpun = false;

        function setupSpinner() {
            const track = document.getElementById('spinner-track');
            track.innerHTML = ''; 
            // Buat loop panjang
            const totalLoops = 5; 
            const totalImages = 20;
            for (let i = 0; i < totalLoops; i++) {
                for (let j = 1; j <= totalImages; j++) {
                    const item = document.createElement('div');
                    item.className = 'spin-item';
                    const img = document.createElement('img');
                    img.src = `F${j}.webp`;
                    item.appendChild(img);
                    track.appendChild(item);
                }
            }
        }

        function startSpin() {
            if (hasSpun) return;
            hasSpun = true;
            document.getElementById('btn-spin-img').style.display = 'none';

            const track = document.getElementById('spinner-track');
            const itemWidth = 220; // 200px + 20px margin
            
            // Target Menang (Random)
            const randomWinIndex = Math.floor(Math.random() * (95 - 75 + 1)) + 75;
            // Hitung Result (Karena index array mulai 0, tapi nama file mulai F1)
            // Modulo logic: Index 0 = F1, Index 19 = F20
            const winningNumber = (randomWinIndex % 20) + 1; 

            // Kalkulasi Posisi Center
            const containerWidth = 1200;
            const scrollPosition = (randomWinIndex * itemWidth) - (containerWidth / 2) + (itemWidth / 2);
            const randomOffset = Math.floor(Math.random() * 40) - 20; 
            const finalPosition = scrollPosition + randomOffset;

            // Animasi Spin
            track.style.transition = 'transform 6s cubic-bezier(0.15, 0, 0.10, 1)'; 
            track.style.transform = `translateX(-${finalPosition}px)`;

            track.addEventListener('transitionend', () => {
                showResult(winningNumber);
            }, { once: true });
        }

        function showResult(number) {
            const popup = document.getElementById('result-popup');
            const img = document.getElementById('result-image');
            
            // Set source gambar pemenang
            img.src = `F${number}.webp`;
            
            openOverlay('result-popup');
        }

        function closeResult() {
            const popup = document.getElementById('result-popup');
            popup.style.opacity = '0';
            setTimeout(() => {
                popup.style.display = 'none';
                // Opsional: Redirect ke Challenge 2 atau Reset
                alert("Lanjut ke Challenge berikutnya? (Implementasi logika selanjutnya disini)");
            }, 500);
        }

    </script>
</body>
</html>
